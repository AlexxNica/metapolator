#!/usr/bin/env nodejs

// metapolator command line interface
var requirejs = require('requirejs');

requirejs.config({
    nodeRequire: require
  , baseUrl: __dirname + '/app/lib'
  , paths: {
        'require/domReady': 'bower_components/requirejs-domready/domReady'
      , 'require/text': 'bower_components/requirejs-text/text'
      , 'gonzales': 'npm_converted/gonzales/lib'
      , 'angular': 'bower_components/angular/angular'
      , 'obtain': 'obtainJS/lib'
      , 'ufojs': 'ufoJS/lib'
    }
  , shim: {
      angular: {
        exports: 'angular'
      }
    }
});

(function(require) {
    var commands = {
        'import': 'importer/cli'
        }
    , command
    ;
    
    if(!(process.argv[2] in commands))
        throw new Error(['Unkown command ', process.argv[2], ' try one of:\n - '
            , Object.keys(commands).join('\n - ')
            ].join('')
        )
    command = process.argv[2];
    require([commands[command]], function (command) {
        "use strict";
        command.main(process.argv.slice(2))
    })
})(requirejs)
